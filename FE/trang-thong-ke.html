<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./css/trang-thong-ke.css">
    <link rel="stylesheet" href="./css/slideBar.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js">
    </script> -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>

</head>

<body>
    <div style="display: flex; height: 100vh; width: 100%;">
        <div class="sidebar">
            <img src="./img/Logo_PTIT.jpg">
            <ul>
                <li onclick="window.location.href='quan-ly-nguoi-dung.html'">Quản lý người dùng</li>
                <li onclick="window.location.href='trang-bai-thi.html'">Quản lý kỳ thi</li>
                <li onclick="window.location.href='trang-thong-ke.html'" style="background-color: #f2f2f2;">Thống kê</li>
            </ul>
            <div class="user-login-container">
                <div id="user-infor"> </div>
                <button onclick="logOut()"> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 13v-2H7V8l-5 4 5 4v-3z"></path><path d="M20 3h-9c-1.103 0-2 .897-2 2v4h2V5h9v14h-9v-4H9v4c0 1.103.897 2 2 2h9c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2z"></path></svg> Log out </button>
            </div>
        </div>
        <div class="content" style="width: 85%; margin-bottom: 20px;">
            <div style="background-color: rgb(255, 255, 255); border-radius: 10px; text-align: center; padding: 20px;">
                <h1>Trang thống kê của Học viện</h1>
            </div>
            <div style="display: flex;justify-content: space-evenly; margin: 2rem 0;">
                <div class="grid-pane">
                    <div class="grid-element">
                        <h4>Tổng số bài đã làm</h4>
                        <h1 id="finishExam" style="padding: 10px 0px;"></h1>
                    </div>
                    <div class="grid-element">
                        <h4>Tỷ lệ hoàn thành</h4>
                        <h1 id="completionRate" style="padding: 10px 0px;"></h1>
                    </div>
                    <div class="grid-element">
                        <h4>Tổng số bài chưa làm</h4>
                        <h1 id="unFinishExam" style="padding: 10px 0px;"></h1>
                    </div>
                    <div class="grid-element">
                        <h4>Điểm trung bình</h4>
                        <h1 id="scoreRate" style="padding: 10px 0px;"></h1>
                    </div>
                </div>
                <div style="padding: 30px; background-color: white; display: flex; justify-content: center;margin: 0px 0px; border-radius: 15px; width: 50%;">
                    <canvas id="myChart" style="width:100%;max-width:700px"></canvas>
                </div>
            </div>
            <div class="exam-list">
                <div style="display: flex; justify-content: space-between;">
                    <h1 style="text-align: center; line-height: 57.6px;">Bảng tổng hợp kết quả</h1>
                    <button id="convertExcel" onclick="saveExcel()">
                        <div style="display: flex; align-items: center; justify-content: center; gap:0.5rem">
                            <i class="fa-solid fa-table"> </i>
                            <h3>Excel</h3>
                        </div>
                    </button>
                </div>
                <input type="text" id="myInput" onkeyup="search()" placeholder="Tìm theo tên" style="margin: 10px; height: 30px;padding: 0px 10px; border-radius: 10px;">
          
                <table class="table-content" id="products-datatable">
                    <thead>
                        <tr>
                            <th onclick="sort(0)">Họ và tên<i class="fa-solid fa-sort"></i></th>
                            <th onclick="sort(1)">Mã SV <i class="fa-solid fa-sort"></i></th></th>
                            <th onclick="sort(2)">Số bài đã làm <i class="fa-solid fa-sort"></i></th>
                            <th onclick="sort(3)">Số bài chưa làm<i class="fa-solid fa-sort"></i></th>
                            <th onclick="sort(4)">Tỉ lệ hoàn thành <i class="fa-solid fa-sort"></i></th>
                            <th onclick="sort(5)">Điểm trung bình<i class="fa-solid fa-sort"></i></th>
                        </tr>
                    </thead>
                    <tbody id="result-table">

                    </tbody>
                </table>

          
            </div>
        </div>
        <script src="./js/reuse.js"></script>
        <script src="./js/service.js"></script>
        <script src="./js/statistic.js"></script>
        <script src="./js/table2Excel.js"></script>
        <script src="./js/loadUser.js"></script>
</body>

</html>